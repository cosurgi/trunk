./NDimTable_MarginalDistribution_Test > test2.tmp 2>&1
diff -s test2.tmp NDimTable_MarginalDistribution_Test_correct_output.txt

// Tᵦᵧᵥᵨᵩᵪᵢᵣ=AᵦᵧᵥBᵨᵩCᵪDᵢᵣ 
//  ⋮⋮⋮⋮⋮⋮⋮⋮  ⋮⋮⋮ ⋮⋮ ⋮ ⋮⋮ 
//  23243252  232 43 2 52 


Allocating A, B, C, D
dim_A sizes = 2,3,2 

Print A = 
Aᵦᵧᵥ[0,0,0]=0.1000000000	Aᵦᵧᵥ[0,0,1]=100.1000000000	
Aᵦᵧᵥ[0,1,0]=10.1000000000	Aᵦᵧᵥ[0,1,1]=110.1000000000	
Aᵦᵧᵥ[0,2,0]=20.1000000000	Aᵦᵧᵥ[0,2,1]=120.1000000000	

Aᵦᵧᵥ[1,0,0]=1.1000000000	Aᵦᵧᵥ[1,0,1]=101.1000000000	
Aᵦᵧᵥ[1,1,0]=11.1000000000	Aᵦᵧᵥ[1,1,1]=111.1000000000	
Aᵦᵧᵥ[1,2,0]=21.1000000000	Aᵦᵧᵥ[1,2,1]=121.1000000000	


dim_B sizes = 4,3 

Print B = 
Bᵨᵩ[0,0]=0.2000000000	Bᵨᵩ[0,1]=10.2000000000	Bᵨᵩ[0,2]=20.2000000000	
Bᵨᵩ[1,0]=1.2000000000	Bᵨᵩ[1,1]=11.2000000000	Bᵨᵩ[1,2]=21.2000000000	
Bᵨᵩ[2,0]=2.2000000000	Bᵨᵩ[2,1]=12.2000000000	Bᵨᵩ[2,2]=22.2000000000	
Bᵨᵩ[3,0]=3.2000000000	Bᵨᵩ[3,1]=13.2000000000	Bᵨᵩ[3,2]=23.2000000000	

dim_C sizes = 2 

Print C = 
Cᵪ[0]=0.3000000000	Cᵪ[1]=1.3000000000	
dim_D sizes = 5,2 

Print D = 
Dᵢᵣ[0,0]=0.4000000000	Dᵢᵣ[0,1]=10.4000000000	
Dᵢᵣ[1,0]=1.4000000000	Dᵢᵣ[1,1]=11.4000000000	
Dᵢᵣ[2,0]=2.4000000000	Dᵢᵣ[2,1]=12.4000000000	
Dᵢᵣ[3,0]=3.4000000000	Dᵢᵣ[3,1]=13.4000000000	
Dᵢᵣ[4,0]=4.4000000000	Dᵢᵣ[4,1]=14.4000000000	

dim_T sizes = 2,3,2,4,3,2,5,2 

assert T ... OK

Normalize A,B,C,D
sumA = 727.2000000000
sumB = 140.4000000000
sumC = 1.6000000000
sumD = 74.0000000000
after dividing by sum:
sumA2 = 1.0000000000
sumB2 = 1.0000000000
sumC2 = 1.0000000000
sumD2 = 1.0000000000
dim_Tnorm sizes = 2,3,2,4,3,2,5,2 
std::numeric_limits<double>::epsilon() = 2.2204460492503131e-16

assert Tnorm ... OK

Trying marginal distributions now
// Tᵦᵧᵥᵨᵩᵪᵢᵣ=AᵦᵧᵥBᵨᵩCᵪDᵢᵣ 
//  ⋮⋮⋮⋮⋮⋮⋮⋮  ⋮⋮⋮ ⋮⋮ ⋮ ⋮⋮ 
//  23243252  232 43 2 52 
// Aᵦᵧᵥ     =Tᵦᵧᵥ..... 
//  ⋮⋮⋮⋮⋮⋮⋮⋮  ⋮⋮⋮⋮⋮⋮⋮⋮ 
//  23243252  23243252 
// B   ᵨᵩ   =T...ᵨᵩ... 
//  ⋮⋮⋮⋮⋮⋮⋮⋮  ⋮⋮⋮⋮⋮⋮⋮⋮ 
//  23243252  23243252 
// C     ᵪ  =T.....ᵪ.. 
//  ⋮⋮⋮⋮⋮⋮⋮⋮  ⋮⋮⋮⋮⋮⋮⋮⋮ 
//  23243252  23243252 
// D      ᵢᵣ=T......ᵢᵣ 
//  ⋮⋮⋮⋮⋮⋮⋮⋮  ⋮⋮⋮⋮⋮⋮⋮⋮ 
//  23243252  23243252 

Aᵦᵧᵥ[0,0,0]=0.0001375138	Aᵦᵧᵥ[0,0,1]=0.1376512651	
Aᵦᵧᵥ[0,1,0]=0.0138888889	Aᵦᵧᵥ[0,1,1]=0.1514026403	
Aᵦᵧᵥ[0,2,0]=0.0276402640	Aᵦᵧᵥ[0,2,1]=0.1651540154	

Aᵦᵧᵥ[1,0,0]=0.0015126513	Aᵦᵧᵥ[1,0,1]=0.1390264026	
Aᵦᵧᵥ[1,1,0]=0.0152640264	Aᵦᵧᵥ[1,1,1]=0.1527777778	
Aᵦᵧᵥ[1,2,0]=0.0290154015	Aᵦᵧᵥ[1,2,1]=0.1665291529	


Aᵦᵧᵥ[0,0,0]=0.0001375138	Aᵦᵧᵥ[0,0,1]=0.1376512651	
Aᵦᵧᵥ[0,1,0]=0.0138888889	Aᵦᵧᵥ[0,1,1]=0.1514026403	
Aᵦᵧᵥ[0,2,0]=0.0276402640	Aᵦᵧᵥ[0,2,1]=0.1651540154	

Aᵦᵧᵥ[1,0,0]=0.0015126513	Aᵦᵧᵥ[1,0,1]=0.1390264026	
Aᵦᵧᵥ[1,1,0]=0.0152640264	Aᵦᵧᵥ[1,1,1]=0.1527777778	
Aᵦᵧᵥ[1,2,0]=0.0290154015	Aᵦᵧᵥ[1,2,1]=0.1665291529	


Aᵦᵧᵥ[0,0,0]=0.1000000000	Aᵦᵧᵥ[0,0,1]=100.1000000000	
Aᵦᵧᵥ[0,1,0]=10.1000000000	Aᵦᵧᵥ[0,1,1]=110.1000000000	
Aᵦᵧᵥ[0,2,0]=20.1000000000	Aᵦᵧᵥ[0,2,1]=120.1000000000	

Aᵦᵧᵥ[1,0,0]=1.1000000000	Aᵦᵧᵥ[1,0,1]=101.1000000000	
Aᵦᵧᵥ[1,1,0]=11.1000000000	Aᵦᵧᵥ[1,1,1]=111.1000000000	
Aᵦᵧᵥ[1,2,0]=21.1000000000	Aᵦᵧᵥ[1,2,1]=121.1000000000	


Bᵨᵩ[0,0]=0.0014245014	Bᵨᵩ[0,1]=0.0726495726	Bᵨᵩ[0,2]=0.1438746439	
Bᵨᵩ[1,0]=0.0085470085	Bᵨᵩ[1,1]=0.0797720798	Bᵨᵩ[1,2]=0.1509971510	
Bᵨᵩ[2,0]=0.0156695157	Bᵨᵩ[2,1]=0.0868945869	Bᵨᵩ[2,2]=0.1581196581	
Bᵨᵩ[3,0]=0.0227920228	Bᵨᵩ[3,1]=0.0940170940	Bᵨᵩ[3,2]=0.1652421652	

Bᵨᵩ[0,0]=0.0014245014	Bᵨᵩ[0,1]=0.0726495726	Bᵨᵩ[0,2]=0.1438746439	
Bᵨᵩ[1,0]=0.0085470085	Bᵨᵩ[1,1]=0.0797720798	Bᵨᵩ[1,2]=0.1509971510	
Bᵨᵩ[2,0]=0.0156695157	Bᵨᵩ[2,1]=0.0868945869	Bᵨᵩ[2,2]=0.1581196581	
Bᵨᵩ[3,0]=0.0227920228	Bᵨᵩ[3,1]=0.0940170940	Bᵨᵩ[3,2]=0.1652421652	

Bᵨᵩ[0,0]=0.2000000000	Bᵨᵩ[0,1]=10.2000000000	Bᵨᵩ[0,2]=20.2000000000	
Bᵨᵩ[1,0]=1.2000000000	Bᵨᵩ[1,1]=11.2000000000	Bᵨᵩ[1,2]=21.2000000000	
Bᵨᵩ[2,0]=2.2000000000	Bᵨᵩ[2,1]=12.2000000000	Bᵨᵩ[2,2]=22.2000000000	
Bᵨᵩ[3,0]=3.2000000000	Bᵨᵩ[3,1]=13.2000000000	Bᵨᵩ[3,2]=23.2000000000	

Cᵪ[0]=0.1875000000	Cᵪ[1]=0.8125000000	
Cᵪ[0]=0.1875000000	Cᵪ[1]=0.8125000000	
Cᵪ[0]=0.3000000000	Cᵪ[1]=1.3000000000	
Dᵢᵣ[0,0]=0.0054054054	Dᵢᵣ[0,1]=0.1405405405	
Dᵢᵣ[1,0]=0.0189189189	Dᵢᵣ[1,1]=0.1540540541	
Dᵢᵣ[2,0]=0.0324324324	Dᵢᵣ[2,1]=0.1675675676	
Dᵢᵣ[3,0]=0.0459459459	Dᵢᵣ[3,1]=0.1810810811	
Dᵢᵣ[4,0]=0.0594594595	Dᵢᵣ[4,1]=0.1945945946	

Dᵢᵣ[0,0]=0.0054054054	Dᵢᵣ[0,1]=0.1405405405	
Dᵢᵣ[1,0]=0.0189189189	Dᵢᵣ[1,1]=0.1540540541	
Dᵢᵣ[2,0]=0.0324324324	Dᵢᵣ[2,1]=0.1675675676	
Dᵢᵣ[3,0]=0.0459459459	Dᵢᵣ[3,1]=0.1810810811	
Dᵢᵣ[4,0]=0.0594594595	Dᵢᵣ[4,1]=0.1945945946	

Dᵢᵣ[0,0]=0.4000000000	Dᵢᵣ[0,1]=10.4000000000	
Dᵢᵣ[1,0]=1.4000000000	Dᵢᵣ[1,1]=11.4000000000	
Dᵢᵣ[2,0]=2.4000000000	Dᵢᵣ[2,1]=12.4000000000	
Dᵢᵣ[3,0]=3.4000000000	Dᵢᵣ[3,1]=13.4000000000	
Dᵢᵣ[4,0]=4.4000000000	Dᵢᵣ[4,1]=14.4000000000	


assert calcMarginalDistribution ... OK
checking operator == and != ... OK
checking index contraction: 3,6,7 vs. 3,6,7 
sumAi= 1.0000000000
sumBi= 1.0000000000
sumCi= 1.0000000000
sumDi= 1.0000000000

assert TnormSizes ... OK
sumTi= 1.0000000000

Trying marginal distributions (using spatial sizes) now ... OK
Aᵦᵧᵥ[0,0,0]=0.1000000000	Aᵦᵧᵥ[0,0,1]=100.1000000000	
Aᵦᵧᵥ[0,1,0]=10.1000000000	Aᵦᵧᵥ[0,1,1]=110.1000000000	
Aᵦᵧᵥ[0,2,0]=20.1000000000	Aᵦᵧᵥ[0,2,1]=120.1000000000	

Aᵦᵧᵥ[1,0,0]=1.1000000000	Aᵦᵧᵥ[1,0,1]=101.1000000000	
Aᵦᵧᵥ[1,1,0]=11.1000000000	Aᵦᵧᵥ[1,1,1]=111.1000000000	
Aᵦᵧᵥ[1,2,0]=21.1000000000	Aᵦᵧᵥ[1,2,1]=121.1000000000	


Bᵨᵩ[0,0]=0.2000000000	Bᵨᵩ[0,1]=10.2000000000	Bᵨᵩ[0,2]=20.2000000000	
Bᵨᵩ[1,0]=1.2000000000	Bᵨᵩ[1,1]=11.2000000000	Bᵨᵩ[1,2]=21.2000000000	
Bᵨᵩ[2,0]=2.2000000000	Bᵨᵩ[2,1]=12.2000000000	Bᵨᵩ[2,2]=22.2000000000	
Bᵨᵩ[3,0]=3.2000000000	Bᵨᵩ[3,1]=13.2000000000	Bᵨᵩ[3,2]=23.2000000000	

Cᵪ[0]=0.3000000000	Cᵪ[1]=1.3000000000	
Dᵢᵣ[0,0]=0.4000000000	Dᵢᵣ[0,1]=10.4000000000	
Dᵢᵣ[1,0]=1.4000000000	Dᵢᵣ[1,1]=11.4000000000	
Dᵢᵣ[2,0]=2.4000000000	Dᵢᵣ[2,1]=12.4000000000	
Dᵢᵣ[3,0]=3.4000000000	Dᵢᵣ[3,1]=13.4000000000	
Dᵢᵣ[4,0]=4.4000000000	Dᵢᵣ[4,1]=14.4000000000	

sumAiS= 1.0000000000
sumBiS= 1.0000000000
sumCiS= 1.0000000000
sumDiS= 1.0000000000
sumAiS2= 727.2000000000
sumBiS2= 140.4000000000
sumCiS2= 1.6000000000
sumDiS2= 74.0000000000
